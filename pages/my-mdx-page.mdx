import { PostHeader } from "../components/post-header"

<PostHeader title="zustand åŸç†ä»‹ç»" summary="daishi çš„ inmutable çš„æ•°æ®æµæ–¹æ¡ˆ" time="2023-03-19" />

 # å¥½çš„çŠ¶æ€ç®¡ç†åº“å…·æœ‰çš„ç‰¹å®š

1. å¯æ‹“å±•æ€§
2. æ˜“ä¸Šæ‰‹ ï¼ˆæ¦‚å¿µç®€å•ï¼ŒAPI è®¾è®¡ç®€å•ï¼‰
3. å¯ä»¥è‡ªåŠ¨ä¼˜åŒ– ï¼ˆæ¯”å¦‚è‡ªåŠ¨é¿å… re render, tree shaking å‹å¥½ï¼‰

 # æ–‡æ¡£åŠŸèƒ½ç®€å•åˆ—ä¸¾

 ## åŸºæœ¬ä½¿ç”¨
 > æ–‡æ¡£åˆ—ä¸¾å‡ºæ¥çš„åŠŸèƒ½ç®€å•æšä¸¾ä¸€ä¸‹

<CH.Code>
```ts main.ts focus=3
import { create } from 'zustand'

const useStore = create((set) => ({
  bears: 0,
  increasePopulation: () => set((state) => ({ bears: state.bears + 1 })),
  removeAllBears: () => set({ bears: 0 }),
}))

function BearCounter() {
  const bears = useStore((state) => state.bears)
  return <h1>{bears} around here...</h1>
}
```
</CH.Code>
```mermaid
graph TD;
A[å¼€å§‹] --> B[create æ˜¯å¦ä¼ å…¥äº†å‡½æ•°];
B --yes--> C["createImpl(createState)"];
B --no-->D[createImpl]
C --> E{"createState æ˜¯ä¸æ˜¯ function"}
E --yes-->F["api = createStore(createState)"]
E--no--> G["api = createState"]
F-->createStoreImpl["createStoreImpl(createState)"]
createStoreImpl --> delclate["return api= {setStateï¼ŒgetStateï¼Œsubscribeï¼Œdestroy}"]
delclate--> createState["call () => ({
  count: 0,
  text: 'hello',
}"]
G-->useBoundStore['constractor useBoundStore = useStore return useBoundStore']
createState-->useBoundStore
useBoundStore-->useStore["return useSyncExternalStoreWithSelector(api.subscribe, api.getState, api.getServerState || api.getState, selector,equalityFn )"]
```

<CH.Scrollycoding>
ç¬¬ä¸€æ®µæµ‹è¯•
---
```js main.js focus=2
function state(props) {
  const result = []
}
```
---
ç¬¬äºŒæ®µæµ‹è¯•


[222hang](focus://2:2)

```js main.js focus=3
function state(props) {
  const result = []
  return result
}
```
---



[222hang](focus://main1.js#2:2)

```js main1.js focus=3
function state(props) {
  const result = []
  return result
}
```
---

</CH.Scrollycoding>



# Spotlight

This is how to use the `<CH.Spotlight>` component. Lorem ipsum dolor sit amet consectetur adipisicing elit. Quisquam, quia! Quidem, quisquam.

<CH.Spotlight>

```js app.js
function lorem(ipsum, dolor = 1) {
  const sit = ipsum == null && 0;
  dolor = sit - amet(dolor);
  return sit ? consectetur(ipsum) : [];
}
```

---

Change focus

```js app.js focus=2:4

```

---

Or change the code

```js app.js focus=6:10
function lorem(ipsum, dolor = 1) {
  const sit = ipsum == null && 0;
  dolor = sit - amet(dolor);
  return sit ? consectetur(ipsum) : [];
}

function adipiscing(...elit) {
  console.log(elit);
  return elit.map((ipsum) => ipsum.sit);
}
```

---

Or change the file

<CH.Code>

```js app.js focus=1:4
function adipiscing(...elit) {
  console.log(elit);
  return elit.map((ipsum) => ipsum.sit);
}
```

---

```css styles.css
.lorem {
  color: #fff;
  padding: 10px;
  background: #000;
}
```

</CH.Code>

---

### By the way

- you can
- put any
- markdown
- here

ğŸ‘

```js app.js

```

</CH.Spotlight>